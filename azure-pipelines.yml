# # Starter pipeline
# # Start with a minimal pipeline that you can customize to build and deploy your code.
# # Add steps that build, run tests, deploy, and more:
# # https://aka.ms/yaml

# trigger:
# - none

# pool:
#   name : evaluation

# steps:


# - task: Bash@3
#   inputs:
#     targetType: 'inline'
#     script: 'aws --version'
# - task: Bash@3
#   inputs:
#     targetType: 'inline'
#     script: 'aws cloudformation deploy --template-file cftemplate --stack-name test  --parameter-overrides KeyName=trail'



# --------------
# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- none

pool:
  name: evaluation

steps:
- task: Bash@3
  inputs:
    targetType: 'inline'
    script: 'aws --version'

- script: |
    if aws cloudformation describe-stacks --stack-name test >/dev/null 2>&1; then
      echo "Stack already exists, skipping deployment."
    else
      aws cloudformation deploy --template-file cftemplate --stack-name test --parameter-overrides KeyName=trail
    fi
  displayName: 'Deploy CloudFormation Stack'
